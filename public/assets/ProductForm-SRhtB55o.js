import{t as P,d as q,r as u,g as D,j as e,_ as z,h as y}from"./index-OYdop1FP.js";import{D as j}from"./DashboardLayout-2V8NA-8S.js";import{L as S}from"./loader-circle-Bl16au8U.js";import{A as L}from"./arrow-left-BpvZiPKE.js";import{U as _}from"./upload-BqdF1x88.js";import{S as A}from"./save-BoBVndYK.js";import"./Logo-DIka_k_q.js";import"./user-CStstmQ6.js";import"./chevron-down-DuasZ1GO.js";import"./settings-vvn4CTqi.js";import"./layout-dashboard-DXxK-L7L.js";import"./package-Bt9ERok5.js";function $(){var b,h,f;const{id:v}=P(),d=q(),x=!!v,n={listing:null},N=async r=>({unwrap:async()=>({})}),[t,a]=u.useState({title:"",categoryId:"",subcategoryId:"",price:"",stock:"",condition:"new",description:"",locationId:"",currency:"BIF",isNegotiable:!1,canDeliver:!1}),[l,g]=u.useState([]),[E,w]=u.useState([]),m={categories:[{id:"1",name:"Électronique"},{id:"2",name:"Mode"}]},p={locations:[{id:"1",name:"Paris"},{id:"2",name:"Lyon"}]};u.useEffect(()=>{if(n!=null&&n.listing){const r=n.listing;a({title:r.title,categoryId:r.category_id,subcategoryId:r.subcategory_id||"",price:r.price,stock:r.stock,condition:r.condition,description:r.description,locationId:r.location_id,currency:r.currency,isNegotiable:r.is_negotiable,canDeliver:r.can_deliver}),w(r.media||[])}},[n]);const I=r=>{r.target.files&&g([...l,...Array.from(r.target.files)])},k=r=>{g(l.filter((s,c)=>c!==r))},{user:o}=D();if((b=o==null?void 0:o.accountType)!=null&&b.startsWith("seller_")&&(o==null?void 0:o.verificationStatus)!=="approved")return e.jsx(j,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx("div",{className:"bg-yellow-100 p-4 rounded-full mb-4",children:e.jsx(S,{className:"w-8 h-8 text-yellow-600 animate-spin"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Compte en attente de validation"}),e.jsx("p",{className:"text-gray-600 max-w-md mb-6",children:"Votre compte vendeur est actuellement en cours d'examen par nos administrateurs. Vous pourrez publier des produits une fois votre compte approuvé."}),e.jsx("button",{onClick:()=>d("/dashboard"),className:"px-6 py-2 bg-[#000435] text-white rounded-full hover:bg-[#000435]/90 transition-colors",children:"Retour au tableau de bord"})]})});const C=async r=>{var c;r.preventDefault();const s=new FormData;s.append("title",t.title),s.append("categoryId",t.categoryId),s.append("subcategoryId",t.subcategoryId||""),s.append("price",t.price),s.append("stock",t.stock),s.append("condition",t.condition),s.append("description",t.description),s.append("locationId",t.locationId),s.append("currency",t.currency),s.append("isNegotiable",t.isNegotiable?"true":"false"),s.append("canDeliver",t.canDeliver?"true":"false"),l.forEach(i=>{s.append("images",i)});try{await N(s).unwrap(),y.success("Produit créé avec succès !"),d("/dashboard/products")}catch(i){console.error("Add product error:",i),y.error(((c=i==null?void 0:i.data)==null?void 0:c.message)||"Une erreur est survenue")}};return e.jsxs(j,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("button",{onClick:()=>d("/dashboard/products"),className:"flex items-center gap-2 text-gray-600 hover:text-[#000435] mb-4 transition-colors",children:[e.jsx(L,{size:20}),"Retour aux produits"]}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:x?"Modifier le produit":"Ajouter un produit"})]}),e.jsxs("form",{onSubmit:C,className:"max-w-4xl",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Images du produit"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 text-center hover:border-[#000435] transition-colors cursor-pointer",children:[e.jsx(_,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Cliquez pour télécharger ou glissez-déposez"}),e.jsx("p",{className:"text-sm text-gray-500",children:"PNG, JPG jusqu'à 10MB"}),e.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:I,className:"hidden",id:"image-upload"}),e.jsx("label",{htmlFor:"image-upload",className:"absolute inset-0 cursor-pointer"})]}),l.length>0&&e.jsx("div",{className:"grid grid-cols-4 gap-4 mt-4",children:l.map((r,s)=>e.jsxs("div",{className:"relative aspect-square bg-gray-100",children:[e.jsx("button",{type:"button",onClick:()=>k(s),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:e.jsx(z,{size:16})}),e.jsx("img",{src:URL.createObjectURL(r),alt:`Preview ${s}`,className:"w-full h-full rounded-lg object-cover"})]},s))})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de base"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Titre du produit *"}),e.jsx("input",{type:"text",required:!0,value:t.title,onChange:r=>a({...t,title:r.target.value}),placeholder:"Ex: iPhone 13 Pro 256GB",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Catégorie *"}),e.jsx("select",{required:!0,value:t.categoryId,onChange:r=>a({...t,categoryId:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all",children:(h=m==null?void 0:m.categories)==null?void 0:h.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"État *"}),e.jsxs("select",{required:!0,value:t.condition,onChange:r=>a({...t,condition:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all",children:[e.jsx("option",{value:"new",children:"Neuf"}),e.jsx("option",{value:"likenew",children:"Comme neuf"}),e.jsx("option",{value:"good",children:"Bon état"}),e.jsx("option",{value:"acceptable",children:"État acceptable"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prix (BIF) *"}),e.jsx("input",{type:"number",required:!0,value:t.price,onChange:r=>a({...t,price:r.target.value}),placeholder:"50000",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock disponible *"}),e.jsx("input",{type:"number",required:!0,value:t.stock,onChange:r=>a({...t,stock:r.target.value}),placeholder:"10",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Localisation *"}),e.jsxs("select",{required:!0,value:t.locationId,onChange:r=>a({...t,locationId:r.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all",children:[e.jsx("option",{value:"",children:"Sélectionner une ville"}),(f=p==null?void 0:p.locations)==null?void 0:f.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),e.jsx("textarea",{required:!0,value:t.description,onChange:r=>a({...t,description:r.target.value}),placeholder:"Décrivez votre produit en détail...",rows:6,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-[#000435] focus:border-transparent transition-all resize-none"}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Minimum 50 caractères"})]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>d("/dashboard/products"),className:"flex-1 px-6 py-3 border-2 border-gray-300 text-gray-700 rounded-full font-medium hover:bg-gray-50 transition-all",children:"Annuler"}),e.jsxs("button",{type:"submit",className:"flex-1 flex items-center justify-center gap-2 bg-[#000435] text-white px-6 py-3 rounded-full font-medium hover:bg-[#000435]/90 transition-all shadow-md hover:shadow-lg",children:[e.jsx(A,{size:20}),x?"Mettre à jour":"Publier le produit"]})]})]})]})}export{$ as default};
